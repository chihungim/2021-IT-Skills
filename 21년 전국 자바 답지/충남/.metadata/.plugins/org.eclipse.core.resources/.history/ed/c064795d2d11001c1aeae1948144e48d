package view;

import java.awt.BorderLayout;
import java.awt.Component;
import java.awt.FlowLayout;
import java.awt.GridLayout;
import java.text.DecimalFormat;

import javax.swing.DefaultCellEditor;
import javax.swing.JComponent;
import javax.swing.JLabel;
import javax.swing.JScrollPane;
import javax.swing.JSpinner;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.SpinnerNumberModel;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;

public class PurchasePage extends BasePage {

	DefaultTableModel model = new DefaultTableModel(null, "이미지,상품이름,행사,여부,가격,재고,수량,총합".split(",")) {
		public boolean isCellEditable(int row, int column) {
			return false;
		};

		public java.lang.Class<?> getColumnClass(int columnIndex) {
			return JComponent.class;
		};
	};

	DefaultTableCellRenderer dtcr = new DefaultTableCellRenderer() {
		public java.awt.Component getTableCellRendererComponent(javax.swing.JTable table, Object value,
				boolean isSelected, boolean hasFocus, int row, int column) {
			if (value instanceof JComponent) {
				return (JComponent) value;
			} else {
				return super.getTableCellRendererComponent(table, value, isSelected, hasFocus, row, column);
			}
		};
	};

	JTable t = new JTable(model);
	JTextField txt = new JTextField(10);
	DecimalFormat df = new DecimalFormat("#,##0");

	public static class SpinnerEditor extends DefaultCellEditor {
		JSpinner spinner;
		JSpinner.DefaultEditor editor;
		boolean valueSet;
		int up = 1;

		public SpinnerEditor() {
			super(new JTextField());
			spinner = new JSpinner(new SpinnerNumberModel(1, 1, null, up));
		}

		@Override
		public Component getTableCellEditorComponent(JTable table, Object value, boolean isSelected, int row,
				int column) {
			up = (table.getValueAt(row, 2).toString().contentEquals("O")) ? 2 : 1;
			int max = toInt(table.getValueAt(row, 4).toString());
			spinner.setModel(new SpinnerNumberModel(1, 1, max, up));
			spinner.setValue(value);
			return spinner;
		}

		@Override
		public Object getCellEditorValue() {
			return spinner.getValue();
		}
	}

	int no;
	JPanel p;

	public PurchasePage(int no, JPanel p) {
		this.no = no;
		this.p = p;
		ui();
	}

	void ui() {
		add(c = new JPanel(new BorderLayout()));
		add(s = new JPanel(new GridLayout(0, 1)), "South");

		var s_t = new JPanel(new FlowLayout(2));
		var s_s = new JPanel(new FlowLayout(2));

		s.add(s_t);
		s.add(s_s);

		c.add(new JScrollPane(t));

		s_t.add(new JLabel("금액"));
		s_t.add(txt);
	}

}
