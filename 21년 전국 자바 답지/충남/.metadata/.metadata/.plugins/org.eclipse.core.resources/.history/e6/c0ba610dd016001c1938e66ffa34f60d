package Ãæ³²;

import java.awt.Color;
import java.awt.Dimension;
import java.awt.Font;
import java.awt.Image;
import java.awt.Toolkit;
import java.awt.event.ActionListener;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.time.LocalTime;
import java.time.format.DateTimeFormatter;
import java.util.ArrayList;

import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JComponent;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import javax.swing.border.LineBorder;

public class BaseFrame extends JFrame {

	JPanel c, w, e, s, n;
	static int sno;
	static String uno = "", uname, sname;
	static int ubirth, uage;

	static Connection con = DB.con;
	static Statement stmt = DB.stmt;
	//
	static ArrayList<String> metroNames = new ArrayList<String>();
	static ArrayList<String> stNames = new ArrayList<String>();
	static Object metroStInfos[][] = new Object[30 + 1][4];
	static int adjDim[][] = new int[275 + 1][275 + 1];
	static int lineDim[][] = new int[275 + 1][275 + 1];
	static int metroTimeDim[][][] = new int[30 + 1][100][300];
	int INF = 10000000;
	ResultSet rs;

	static {
		try {
			stmt.execute("use metro");
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}

	public BaseFrame(String tit, int w, int h) {
		super("¼­¿ï¸ÞÆ®·Î - " + tit);
		this.setSize(w, h);
		this.setLocationRelativeTo(null);
		this.setDefaultCloseOperation(2);
	}

	void datainit() throws SQLException {
		rs = stmt.executeQuery("select * from metro");
		metroNames.add("");
		while (rs.next()) {
			metroNames.add(rs.getString(2));
		}

		rs = stmt.executeQuery("select * from station");
		stNames.add("");
		while (rs.next()) {
			stNames.add(rs.getString(2));
		}

		for (int i = 1; i < 31; i++) {
			metroStInfos[i][0] = new ArrayList<String>();
			var mstInfo = ((ArrayList) metroStInfos[i][0]);
			mstInfo.add("");

			rs = stmt.executeQuery(
					"select s.name from route r, stations s where r.metro = " + i + " and r.station = s.serial");
			while (rs.next()) {
				mstInfo.add(rs.getString(1));
			}
			rs = stmt.executeQuery("select * from metro where serial = " + i);
			rs.next();
			metroStInfos[i][1] = rs.getString(3);
			metroStInfos[i][2] = rs.getString(4);
			metroStInfos[i][3] = rs.getString(5);
		}

		for (int i = 1; i <= 30; i++) {
			var mstInfo = ((ArrayList) metroStInfos[i][0]);
			for (int j = 1; j <= mstInfo.size() - 2; j++) {
				lineDim[stNames.indexOf(mstInfo.get(j))][stNames.indexOf(mstInfo.get(j + 1))] = i;
			}
		}

		for (int i = 1; i < 276; i++) {
			for (int j = i + 1; j < 276; j++) {
				adjDim[i][j] = adjDim[j][i] = INF;
			}
		}

		rs = stmt.executeQuery("select * from path");

		while (rs.next()) {
			adjDim[rs.getInt(2)][rs.getInt(3)] = rs.getInt(4) * 5;
		}

		for (int i = 1; i <= 30; i++) {
			for (int j = 1; j < 100; j++) {
				var m = (ArrayList<String>) metroStInfos[i][0];
				if (j >= m.size())
					break;

				int start = LocalTime.parse(metroStInfos[i][1].toString()).toSecondOfDay();
				int end = LocalTime.parse(metroStInfos[i][2].toString()).toSecondOfDay();
				int interval = LocalTime.parse(metroStInfos[i][3].toString()).toSecondOfDay();
				metroTimeDim[i][j][0] = j == 1 ? start
						: metroTimeDim[i][j - 1][0]
								+ adjDim[stNames.indexOf(m.get(j - 1))][stNames.indexOf(m.get(j - 1))];
				for (int k = 1; k < 300; k++) {

				}
			}
		}
	}

	String tformat(LocalTime t, String format) {
		return DateTimeFormatter.ofPattern(format).format(t);
	}

	static <T extends JComponent> T sz(T c, int w, int h) {
		c.setPreferredSize(new Dimension(w, h));
		return c;
	}

	static void eMsg(String msg) {
		JOptionPane.showMessageDialog(null, msg, "°æ°í", JOptionPane.ERROR_MESSAGE);
	}

	static void iMsg(String msg) {
		JOptionPane.showMessageDialog(null, msg, "Á¤º¸", JOptionPane.INFORMATION_MESSAGE);
	}

	static JLabel lbl(String text, int alig) {
		JLabel l = new JLabel(text, alig);
		return l;
	}

	static JLabel lbl(String text, int alig, int size) {
		JLabel l = new JLabel(text, alig);
		l.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, size));
		return l;
	}

	static JLabel lblP(String text, int alig, int size) {
		JLabel l = new JLabel(text, alig);
		l.setFont(new Font("¸¼Àº °íµñ", Font.PLAIN, size));
		return l;
	}

	static JLabel lbl(String text, int alig, int size, Color col) {
		JLabel l = new JLabel(text, alig);
		l.setFont(new Font("¸¼Àº °íµñ", Font.BOLD, size));
		return l;
	}

	static JLabel lblP(String text, int alig, int size, Color col) {
		JLabel l = new JLabel(text, alig);
		l.setFont(new Font("¸¼Àº °íµñ", Font.PLAIN, size));
		return l;
	}

	static JButton btn(String text, ActionListener a) {
		JButton b = new JButton(text);
		b.addActionListener(a);
		b.setBackground(new Color(50, 100, 255));
		b.setForeground(Color.white);
		return b;
	}

	static void setLine(JComponent c) {
		c.setBorder(new LineBorder(Color.black));
	}

	static void setLine(JComponent c, Color col) {
		c.setBorder(new LineBorder(col));
	}

	static void setEmpty(JComponent c, int t, int l, int b, int r) {
		c.setBorder(new EmptyBorder(t, l, b, r));
	}

	static ImageIcon img(String path, int w, int h) {
		return new ImageIcon(Toolkit.getDefaultToolkit().getImage("./Áö±ÞÀÚ·á/images/" + path).getScaledInstance(w, h,
				Image.SCALE_SMOOTH));
	}

	static int rei(Object obj) {
		if (obj.toString().isEmpty())
			return 0;
		return Integer.parseInt(obj.toString());
	}

}
